<kac-authentication-section
    section="rolemappings"
    show-editing-buttons="true"
    create-button-label="Create role mapping"
    create-button-class="fa fa-plus"
    update-button-label="Save role mapping"
    open-button-label="Edit role mapping"
    delete-button-label="Delete role mapping">
  <div class="container" id="section-editor" ng-controller="kacRoleMappingsController">

    <div ng-show="showObjectFinder">
      <h2 class="title">Role mappings</h2>
      <finder
        service="service"
        type="role mappings"
        make-url="makeFinderUrl"
      />
    </div>

    <div ng-hide="showObjectFinder">

      <div class="header" ng-if="isNew">
        <h2 class="title">Create role mapping</h2>
      </div>
      <div class="header" ng-if="!isNew">
        <h2 class="title"><i class="fa fa-group"></i> {{ rolemapping.id }}</h2>
      </div>

      <p ng-if="isNew">
        Role mappings specify the association between roles and internal users, hosts or roles set by an external backend
        (e.g. LDAP or Active Directory).
        <br/>
        For further information please refer to the
        <i class="fa fa-globe"></i>
        <a target="_blank" href="https://github.com/floragunncom/search-guard-docs/blob/master/configuration.md#map-users-backend-roles-and-hosts-to-search-guard-roles">
          Search Guard documentation
        </a>.
      </p>
      <p ng-if="!isNew">
        Click on the Save button to apply changes.
      </p>

      <p class="formError" ng-show="errorMessage">{{ errorMessage }}</p>
      <form name="objectForm" id="object-form" method="post" ng-submit="saveObject($event)" novalidate>
        <div class="form-group" ng-show="isNew">
          <label for="object-form-id">Role</label>
          <select
            id="object-form-id"
            name="role"
            class="form-control"
            ng-required="isNew"
            ng-model="rolemapping.id">
            <option ng-repeat="role in roles" value="{{ role.id }}">{{ role.id }}</option>
          </select>
        </div>
        <div class="form-group">
          <label>Internal users</label>
          <div>
            <isteven-multi-select
              input-model="internalUsers.available"
              output-model="internalUsers.selected"
              button-label="icon id"
              item-label="icon id"
              tick-property="selected">
            </isteven-multi-select>
          </div>
        </div>
        <div class="form-group">
          <label>Backend roles</label>
          <div ng-repeat="role in backendroles" class="form-group">
            <div class="input-group">
              <input type="text" ng-model="role.text" class="form-control" placeholder="Role name">
              <div class="input-group-btn">
                <kibi-array-param-remove index="{{ $index }}" model="backendroles"></kibi-array-param-remove>
              </div>
            </div>
          </div>
          <p>
            <kibi-array-param-add label="backend role" model="backendroles"></kibi-array-param-add>
          </p>
        </div>
        <div class="form-group">
          <label>Hosts</label>
          <div ng-repeat="host in hosts" class="form-group">
            <div class="input-group">
              <input type="text" ng-model="host.text" class="form-control" placeholder="Host address or FQDN">
              <div class="input-group-btn">
                <kibi-array-param-remove index="{{ $index }}" model="hosts"></kibi-array-param-remove>
              </div>
            </div>
          </div>
          <p>
            <kibi-array-param-add label="host" model="hosts"></kibi-array-param-add>
          </p>
        </div>

        <button type="submit"></button>
      </form>

    </div>

  </div>

</kac-authentication-section>
